# Copyright (c) 2017, 2019 University of York and others
# This program and the accompanying materials are made available
# under the terms of the Eclipse Public License 2.0 which is
# available at http://www.eclipse.org/legal/epl-2.0.
#
# SPDX-License-Identifier: EPL-2.0
box: openjdk:11.0.3-jdk-stretch

build:
  steps:
    - wercker/maven:
      goals: clean install
      cache_repo: true
      version: 3.6.0

deploy:
  steps:
    - install-packages:
        packages: rsync
    - add-ssh-key:
        keyname: deployment
    - add-to-known_hosts:
        hostname: sftp.york.ac.uk
        fingerprint: 1ksayLs+AwXM/7ljQ4uIgCqHq7Z8U8tPG+iZDAsm51M
        type: rsa
    - script:
        name: uploading update site
        code: |-
          ./upload.sh